<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤§æ•°æ®ä¸äººå·¥æ™ºèƒ½ - æ¨¡å—ä¸‰ï¼šè§†è§‰å™äº‹</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/echarts/5.4.3/echarts.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js"></script>
    <style>
        :root {
            --stage-width: 1920px;
            --stage-height: 1080px;
            --stage-max: 1200px; /* å®é™…æ˜¾ç¤ºæœ€å¤§å®½åº¦ */
            --safe: 60px;
            --bg-color: #000000;
            --card-bg: #2d2d2db3;
            --card-border: #ffffff1f;
            --text-primary: #FFFFFF;
            --text-secondary: #D9D9D9;
            --text-tertiary: #888888;
            --accent: #00ff88;
            --accent-blue: #3b82f6;
            --accent-red: #ff4d4f;
            --accent-purple: #9333ea;
            --code-bg: #1e1e1e;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body { 
            background: #111; 
            font-family: 'Inter', 'PingFang SC', 'Microsoft YaHei', sans-serif;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            color: var(--text-primary);
        }

        /* èˆå°å®¹å™¨ */
        #stage-container {
            width: var(--stage-max);
            height: calc(var(--stage-max) * 9 / 16);
            position: relative;
            background: var(--bg-color);
            border: 1px solid #333;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 0 50px rgba(0,0,0,0.5);
        }

        /* ç½‘æ ¼èƒŒæ™¯ */
        .grid-bg {
            position: absolute;
            inset: 0;
            background-image: 
                linear-gradient(rgba(255,255,255,0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255,255,255,0.03) 1px, transparent 1px);
            background-size: 40px 40px;
            z-index: 0;
            pointer-events: none;
        }

        /* å¹»ç¯ç‰‡é€šç”¨æ ·å¼ */
        .slide {
            position: absolute;
            inset: 0;
            padding: var(--safe);
            display: flex;
            flex-direction: column;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.5s ease;
            z-index: 1;
        }

        .slide.active {
            opacity: 1;
            visibility: visible;
            z-index: 2;
        }

        /* å¤´éƒ¨åŒºåŸŸ */
        .header {
            height: 20%;
            margin-bottom: 2rem;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .slide-title {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            background: linear-gradient(90deg, #fff, #aaa);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .slide-subtitle {
            font-size: 1.5rem;
            color: var(--text-secondary);
            font-weight: 300;
        }

        /* å†…å®¹åŒºåŸŸå¸ƒå±€ */
        .content {
            height: 80%;
            width: 100%;
            position: relative;
        }

        /* å¸ƒå±€ç±»å‹ */
        .split { display: flex; gap: 40px; height: 100%; }
        .split > div { flex: 1; display: flex; flex-direction: column; justify-content: center; }
        
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 40px; height: 100%; }
        .grid-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 30px; height: 100%; }
        
        .big-text { 
            display: flex; 
            flex-direction: column; 
            justify-content: center; 
            align-items: center; 
            text-align: center; 
            height: 100%; 
        }

        .data-first {
            display: flex;
            justify-content: space-around;
            align-items: center;
            height: 100%;
        }

        /* å¡ç‰‡ç»„ä»¶ */
        .card {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 16px;
            padding: 30px;
            height: 100%;
            display: flex;
            flex-direction: column;
            gap: 15px;
            backdrop-filter: blur(10px);
        }

        .card h3 { font-size: 1.8rem; color: var(--accent); margin-bottom: 10px; }
        .card p, .card li { font-size: 1.1rem; line-height: 1.6; color: var(--text-secondary); }
        .card ul { list-style: none; }
        .card li::before { content: "â€¢"; color: var(--accent); margin-right: 10px; }

        /* ä»£ç å— */
        .code-block {
            background: var(--code-bg);
            padding: 20px;
            border-radius: 8px;
            font-family: 'Fira Code', monospace;
            font-size: 1rem;
            color: #d4d4d4;
            border-left: 4px solid var(--accent);
            white-space: pre-wrap;
            overflow-y: auto;
            max-height: 100%;
        }
        .code-keyword { color: #569cd6; }
        .code-string { color: #ce9178; }
        .code-comment { color: #6a9955; }

        /* æ•°æ®æŒ‡æ ‡ */
        .metric-item { text-align: center; }
        .metric-value { font-size: 5rem; font-weight: 800; color: var(--accent); display: block; }
        .metric-label { font-size: 1.5rem; color: var(--text-tertiary); margin-top: 10px; }

        /* å›¾è¡¨å®¹å™¨ */
        .chart-container { width: 100%; height: 100%; }

        /* æ§åˆ¶æ  */
        .controls {
            position: fixed;
            bottom: 20px;
            right: 50%;
            transform: translateX(calc(var(--stage-max)/2 + 20px));
            display: flex;
            gap: 10px;
            z-index: 100;
        }

        .btn {
            background: #333;
            color: #fff;
            border: 1px solid #555;
            padding: 10px 20px;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.9rem;
        }

        .btn:hover { background: var(--accent); color: #000; border-color: var(--accent); }
        .page-indicator { color: #888; margin: auto 10px; font-family: monospace; }

        /* æ ‡ç­¾ */
        .tag {
            display: inline-block;
            padding: 4px 12px;
            background: rgba(0,255,136,0.1);
            color: var(--accent);
            border-radius: 12px;
            font-size: 0.8rem;
            margin-top: auto;
            align-self: flex-start;
        }

        /* è¯äº‘æ¨¡æ‹Ÿ */
        .word-cloud { position: relative; width: 100%; height: 100%; }
        .word { position: absolute; font-weight: bold; opacity: 0; }
    </style>
</head>
<body>

<div id="stage-container">
    <div class="grid-bg"></div>

    <div class="slide active" id="s1">
        <div class="content split">
            <div style="flex: 1.5; justify-content: center;">
                <h1 style="font-size: 4rem; margin-bottom: 20px; color: #fff;">å¤§æ•°æ®ä¸äººå·¥æ™ºèƒ½</h1>
                <h2 style="font-size: 2rem; color: var(--accent); font-weight: 300;">æ¨¡å—ä¸‰ï¼šä»æ•°æ®æŒ–æ˜åˆ°è§†è§‰å™äº‹</h2>
            </div>
            <div style="flex: 1; display: flex; align-items: center; justify-content: center;">
                <div style="width: 300px; height: 300px; border: 2px solid var(--accent); border-radius: 50%; display: flex; align-items: center; justify-content: center; position: relative;">
                    <div style="font-size: 8rem;">ğŸ‘ï¸</div>
                    <div style="position: absolute; width: 100%; height: 100%; border: 1px dashed rgba(255,255,255,0.3); border-radius: 50%; animation: spin 20s linear infinite;"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="slide" id="s2">
        <div class="header"><h1 class="slide-title">æœ¬èŠ‚è¯¾æ ¸å¿ƒç›®æ ‡</h1></div>
        <div class="content grid-3">
            <div class="card">
                <h3>01. æŠ€æœ¯æ“ä½œ</h3>
                <p>æŒæ¡ Matplotlib åŒè½´å›¾è¡¨ (Twin Axis) çš„ç»˜åˆ¶æ–¹æ³•ï¼Œè§£å†³å¤šç»´æ•°æ®é‡çº§å·®å¼‚é—®é¢˜ã€‚</p>
                <span class="tag">Python</span>
            </div>
            <div class="card">
                <h3>02. ç®—æ³•åŸç†</h3>
                <p>ç†è§£ä¸­æ–‡æ–‡æœ¬æŒ–æ˜å…¨æµç¨‹ï¼ŒæŒæ¡ Jieba åˆ†è¯ä¸åœç”¨è¯ (Stop Words) è¿‡æ»¤æœºåˆ¶ã€‚</p>
                <span class="tag">NLP</span>
            </div>
            <div class="card">
                <h3>03. æ‰¹åˆ¤æ€ç»´</h3>
                <p>è¯†åˆ«æ•°æ®å›¾è¡¨ä¸­çš„è§†è§‰ä¿®è¾ä¸è¯¯å¯¼ï¼Œç†è§£ç®—æ³•èƒŒåçš„â€œæŠŠå…³äººâ€ä¼¦ç†ã€‚</p>
                <span class="tag">Ethics</span>
            </div>
        </div>
    </div>

    <div class="slide" id="s3">
        <div class="content big-text">
            <h1 style="font-size: 6rem; color: var(--accent); margin-bottom: 20px;">Visual Narrative</h1>
            <p style="font-size: 2rem; max-width: 800px; color: #fff;">åœ¨å¤§æ•°æ®æ—¶ä»£ï¼Œå›¾è¡¨ä¸å†æ˜¯é…è§’ï¼Œ<br>å®ƒæ˜¯<span style="color: var(--accent); border-bottom: 2px solid var(--accent);">æŠ¥é“çš„ä¸»è§’</span>ã€‚</p>
        </div>
    </div>

    <div class="slide" id="s4">
        <div class="header"><h1 class="slide-title">è§†è§‰ä¿®è¾ Visual Rhetoric</h1></div>
        <div class="content split">
            <div class="card">
                <h3>Edward Tufte</h3>
                <p>è€¶é²å¤§å­¦ç»Ÿè®¡å­¦ä¸æ”¿æ²»å­¦æ•™æˆï¼Œè¢«èª‰ä¸ºâ€œæ•°æ®å¯è§†åŒ–é¢†åŸŸçš„è¾¾èŠ¬å¥‡â€ã€‚</p>
                <p style="margin-top:20px; font-style: italic;">"Graphical excellence is that which gives to the viewer the greatest number of ideas in the shortest time with the least ink in the smallest space."</p>
            </div>
            <div class="card" style="align-items: center; justify-content: center;">
                <div style="font-size: 8rem;">ğŸ“˜</div>
                <p style="margin-top: 20px;">ã€ŠThe Visual Display of Quantitative Informationã€‹</p>
            </div>
        </div>
    </div>

    <div class="slide" id="s5">
        <div class="header"><h1 class="slide-title">æ•°æ®å¢¨æ°´æ¯” Data-Ink Ratio</h1></div>
        <div class="content split">
            <div style="align-items: center; justify-content: center;">
                <div style="font-size: 3rem; background: #222; padding: 40px; border-radius: 16px; border: 1px solid #444;">
                    $$ \text{Ratio} = \frac{\text{Data-Ink}}{\text{Total-Ink}} $$
                </div>
            </div>
            <div class="card">
                <h3>æ ¸å¿ƒå®šä¹‰</h3>
                <ul>
                    <li><strong>Data-Ink</strong>: å›¾è¡¨ä¸­ä¸å¯åˆ é™¤çš„æ ¸å¿ƒæ•°æ®éƒ¨åˆ†ã€‚</li>
                    <li><strong>Total-Ink</strong>: å›¾è¡¨ä¸­ä½¿ç”¨çš„æ‰€æœ‰å¢¨æ°´ï¼ˆåŒ…æ‹¬ç½‘æ ¼ã€èƒŒæ™¯ã€è¾¹æ¡†ï¼‰ã€‚</li>
                    <li><strong>åŸåˆ™</strong>: åœ¨ä¸æŸå¤±ä¿¡æ¯çš„å‰æä¸‹ï¼Œæœ€å¤§åŒ–æ¯”ç‡ï¼Œåˆ é™¤ä¸€åˆ‡è£…é¥°æ€§å™ªéŸ³ã€‚</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="slide" id="s6">
        <div class="header"><h1 class="slide-title">åé¢æ•™æï¼šChart Junk</h1></div>
        <div class="content grid-2">
            <div class="card" style="justify-content: center; align-items: center; background: #2a1111;">
                <div style="width: 200px; height: 200px; background: conic-gradient(from 0deg, #ff4d4f 0deg 120deg, #ff7875 120deg 240deg, #ffa39e 240deg 360deg); border-radius: 50%; box-shadow: 10px 10px 0px #5c0011; transform: rotateX(45deg);"></div>
                <p style="margin-top: 30px; font-family: monospace;">[3D Effect + Shadows + Gradients]</p>
            </div>
            <div class="card">
                <h3 style="color: var(--accent-red);">è§†è§‰å™ªéŸ³ (Visual Noise)</h3>
                <ul>
                    <li>3D æ•ˆæœæ‰­æ›²äº†æ•°æ®çš„çœŸå®æ¯”ä¾‹ã€‚</li>
                    <li>è¿‡å¤šçš„é˜´å½±å’Œæ¸å˜åˆ†æ•£äº†æ³¨æ„åŠ›ã€‚</li>
                    <li>è£…é¥°æ€§å…ƒç´ å¤§äºä¿¡æ¯æ€§å…ƒç´ ã€‚</li>
                    <li><strong>ç»“è®º</strong>ï¼šä¸ºäº†"å¥½çœ‹"è€Œç‰ºç‰²äº†"çœŸå®"ã€‚</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="slide" id="s7">
        <div class="header"><h1 class="slide-title">æ­£é¢æ•™æï¼šCaixin Data</h1></div>
        <div class="content grid-2">
            <div class="card" style="justify-content: center; align-items: center;">
                 <svg width="80%" height="200" style="overflow: visible;">
                     <line x1="0" y1="180" x2="300" y2="180" stroke="#555" stroke-width="1" />
                     <polyline points="0,150 50,140 100,100 150,110 200,60 250,40 300,20" fill="none" stroke="#00ff88" stroke-width="3" />
                     <circle cx="200" cy="60" r="4" fill="#00ff88" />
                     <text x="210" y="55" fill="#fff" font-size="14">å…³é”®æ‹ç‚¹</text>
                 </svg>
            </div>
            <div class="card">
                <h3>æç®€ä¸»ä¹‰ (Minimalism)</h3>
                <ul>
                    <li>å»é™¤èƒŒæ™¯ç½‘æ ¼çº¿ã€‚</li>
                    <li>ä»…ä¿ç•™å…³é”®è¶‹åŠ¿çº¿ã€‚</li>
                    <li>ç›´æ¥åœ¨æ•°æ®ç‚¹æ—æ ‡æ³¨ï¼Œè€Œéä¾èµ–å¤æ‚çš„å›¾ä¾‹ã€‚</li>
                    <li><strong>ç»“è®º</strong>ï¼šè®©æ•°æ®ç›´æ¥è¯´è¯ã€‚</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="slide" id="s8">
        <div class="header"><h1 class="slide-title">å·¥å…·æ€ç»´ï¼šExcel çš„è¾¹ç•Œ</h1></div>
        <div class="content grid-2">
            <div class="card">
                <h3>æ‰€è§å³æ‰€å¾— (WYSIWYG)</h3>
                <p>ä¼˜ç‚¹ï¼šç›´è§‚ã€ä¸Šæ‰‹å¿«ï¼Œé€‚åˆå¤„ç†å°è§„æ¨¡é™æ€æ•°æ®ã€‚</p>
                <div style="margin-top: 20px; background: #fff; color: #000; padding: 10px; border-radius: 4px;">
                    Grid UI Interface
                </div>
            </div>
            <div class="card" style="border-color: var(--accent-red);">
                <h3 style="color: var(--accent-red);">ç—›ç‚¹åœºæ™¯</h3>
                <p>å½“ä½ éœ€è¦åˆ†æ <strong>10å¹´é—´ 3000ä¸ªå¿åŸŸ</strong> çš„ç»æµæ•°æ®æ—¶ï¼š</p>
                <ul>
                    <li>Excel ä¼šå´©æºƒæˆ–æåº¦å¡é¡¿ã€‚</li>
                    <li>é‡å¤æ€§æ“ä½œï¼ˆå¤åˆ¶ç²˜è´´ï¼‰å®¹æ˜“å‡ºé”™ã€‚</li>
                    <li>æ— æ³•å¤ç”¨å¤„ç†é€»è¾‘ã€‚</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="slide" id="s9">
        <div class="header"><h1 class="slide-title">å·¥ç¨‹æ€ç»´ï¼šPython çš„è¿›é˜¶</h1></div>
        <div class="content grid-2">
            <div class="card">
                <h3>ä»£ç åŒ–é€»è¾‘</h3>
                <div class="code-block">for file in data_files:
    clean_data(file)
    plot_chart(file)</div>
            </div>
            <div class="card">
                <h3>æ ¸å¿ƒä¼˜åŠ¿</h3>
                <ul>
                    <li><strong>è‡ªåŠ¨åŒ–</strong>ï¼šè®©æœºå™¨ä»£æ›¿äººå·¥å®Œæˆé‡å¤åŠ³åŠ¨ã€‚</li>
                    <li><strong>å¤ç”¨æ€§ (Reusability)</strong>ï¼šåªéœ€ä¿®æ”¹ä¸€ä¸ªå‚æ•°ï¼Œå³å¯å¤„ç†åƒä¸‡çº§æ•°æ®ã€‚</li>
                    <li><strong>é€æ˜æ€§</strong>ï¼šæ¸…æ´—é€»è¾‘æ¸…æ™°å¯è§ï¼Œæ–¹ä¾¿å›æº¯ã€‚</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="slide" id="s10">
        <div class="content big-text">
            <h2 style="color: var(--text-secondary); margin-bottom: 20px;">PART 01</h2>
            <h1 style="font-size: 5rem; color: #fff;">åŒè½´å™äº‹</h1>
            <h3 style="font-size: 2rem; color: var(--accent); margin-top: 20px;">è§£å†³å¤šç»´æ•°æ®çš„é‡çº§å†²çª</h3>
        </div>
    </div>

    <div class="slide" id="s11">
        <div class="header"><h1 class="slide-title">æ¡ˆä¾‹ï¼šå®¶åº­ç»“æ„çš„â€œä¸€å¢ä¸€å‡â€</h1></div>
        <div class="content split">
            <div class="card">
                <h3>ç¤¾ä¼šå­¦ç°è±¡</h3>
                <p>éšç€å‡ºç”Ÿç‡çš„ä¸‹é™ï¼Œâ€œå®ƒç»æµâ€ï¼ˆå® ç‰©ç»æµï¼‰æ˜¯å¦è¿æ¥äº†çˆ†å‘ï¼Ÿ</p>
                <p style="margin-top: 20px;">æˆ‘ä»¬è¯•å›¾æ¢è®¨è¿™ä¸¤è€…ä¹‹é—´æ˜¯å¦å­˜åœ¨<strong>ç›¸å…³æ€§</strong>ã€‚</p>
            </div>
            <div class="card">
                <h3>æ•°æ®æ¥æº</h3>
                <ul>
                    <li>ğŸ“‰ <strong>å‡ºç”Ÿç‡</strong>ï¼šå›½å®¶ç»Ÿè®¡å±€</li>
                    <li>ğŸ“ˆ <strong>å¸‚åœºè§„æ¨¡</strong>ï¼šã€Šä¸­å›½å® ç‰©è¡Œä¸šç™½çš®ä¹¦ã€‹</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="slide" id="s12">
        <div class="header"><h1 class="slide-title">ç—›ç‚¹ï¼šé‡çº§å·®å¼‚ (Scale Gap)</h1></div>
        <div class="content data-first">
            <div class="metric-item">
                <span class="metric-value" style="color: var(--accent-red);">6.39 â€°</span>
                <span class="metric-label">å‡ºç”Ÿç‡ (åƒåˆ†æ¯”)</span>
            </div>
            <div style="font-size: 3rem; color: #555;">VS</div>
            <div class="metric-item">
                <span class="metric-value" style="color: var(--accent-blue);">5928 äº¿</span>
                <span class="metric-label">å¸‚åœºè§„æ¨¡ (åƒäº¿çº§)</span>
            </div>
        </div>
        <div style="position:absolute; bottom:20px; width:100%; text-align:center; color: var(--text-secondary);">
            å¦‚æœç”»åœ¨åŒä¸€ä¸ªYè½´ä¸Šï¼Œå‡ºç”Ÿç‡ä¼šå˜æˆä¸€æ¡æ¯«æ— æ³¢åŠ¨çš„ç›´çº¿ï¼ˆæ¥è¿‘0ï¼‰ã€‚
        </div>
    </div>

    <div class="slide" id="s13">
        <div class="header"><h1 class="slide-title">æŠ€æœ¯è§£æ³•ï¼šTwin Axis</h1></div>
        <div class="content split">
            <div class="card">
                <h3>æ ¸å¿ƒåŸç†</h3>
                <ul>
                    <li><strong>å…±äº« X è½´</strong>ï¼šå¹´ä»½ï¼ˆ2018-2023ï¼‰ä¿æŒä¸€è‡´ã€‚</li>
                    <li><strong>ç‹¬ç«‹ Y è½´</strong>ï¼š
                        <ul>
                            <li>å·¦è½´ï¼š0 - 15 (â€°)</li>
                            <li>å³è½´ï¼š0 - 6000 (äº¿å…ƒ)</li>
                        </ul>
                    </li>
                </ul>
            </div>
            <div class="card" style="justify-content: center; align-items: center;">
                 <div style="display:flex; justify-content:space-between; width: 80%; border-bottom: 2px solid #fff; position: relative; height: 200px;">
                     <div style="position:absolute; left:0; top:0; bottom:0; border-left: 2px solid var(--accent-red);"></div>
                     <div style="position:absolute; right:0; top:0; bottom:0; border-right: 2px solid var(--accent-blue);"></div>
                     <span style="position:absolute; bottom:-30px; left:45%;">Shared X-Axis</span>
                     <span style="position:absolute; left:-60px; top:50%; color:var(--accent-red);">Left Y</span>
                     <span style="position:absolute; right:-60px; top:50%; color:var(--accent-blue);">Right Y</span>
                 </div>
            </div>
        </div>
    </div>

    <div class="slide" id="s14">
        <div class="header"><h1 class="slide-title">Step 1: æ•°æ®å‡†å¤‡</h1></div>
        <div class="content split">
            <div class="card">
                <div class="code-block">
years = [2018, 2019, 2020, 2021, 2022, 2023]

# å·¦è½´æ•°æ®ï¼šå‡ºç”Ÿç‡ (åƒåˆ†æ¯”)
birth_rate = [10.94, 10.48, 8.52, 7.52, 6.77, 6.39]

# å³è½´æ•°æ®ï¼šå¸‚åœºè§„æ¨¡ (äº¿å…ƒ)
pet_economy = [1708, 2024, 2953, 3942, 4936, 5928]
                </div>
            </div>
            <div class="card">
                <h3>ç»“æ„åŒ–æ•°æ® List</h3>
                <p>ç¡®ä¿ä¸‰ä¸ªåˆ—è¡¨çš„é•¿åº¦å®Œå…¨ä¸€è‡´ï¼ˆlen = 6ï¼‰ã€‚</p>
                <p>è¿™æ˜¯æ•°æ®æ¸…æ´—åçš„æ ‡å‡†è¾“å…¥æ ¼å¼ã€‚</p>
            </div>
        </div>
    </div>

    <div class="slide" id="s15">
        <div class="header"><h1 class="slide-title">Step 2: ç»˜åˆ¶å·¦è½´</h1></div>
        <div class="content split">
            <div class="card">
                 <div class="code-block">
fig, ax1 = plt.subplots(figsize=(10, 6))

color_left = '#FF6B6B' # çº¢è‰²ä»£è¡¨è­¦ç¤º
ax1.set_xlabel('å¹´ä»½')
ax1.set_ylabel('å‡ºç”Ÿç‡ (â€°)', color=color_left)

# ç»˜åˆ¶æŠ˜çº¿å›¾
ax1.plot(years, birth_rate, color=color_left, 
         marker='o', linewidth=3)

ax1.tick_params(axis='y', labelcolor=color_left)
                </div>
            </div>
            <div class="card">
                <h3>å®ä¾‹åŒ–å¯¹è±¡</h3>
                <p><code>ax1</code> æ˜¯æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªåæ ‡è½´å¯¹è±¡ã€‚</p>
                <p>æˆ‘ä»¬å°†å…¶ç›¸å…³çš„æ‰€æœ‰å…ƒç´ ï¼ˆçº¿æ¡ã€æ ‡ç­¾ã€åˆ»åº¦ï¼‰éƒ½è®¾ç½®ä¸ºçº¢è‰²ï¼Œä»¥ç¤ºåŒºåˆ†ã€‚</p>
            </div>
        </div>
    </div>

    <div class="slide" id="s16">
        <div class="header"><h1 class="slide-title">Step 3: åŒè½´é­”æ³• TwinX</h1></div>
        <div class="content split">
            <div class="card">
                 <div class="code-block">
# å…³é”®ä»£ç ï¼šåˆ›å»ºå…±äº«xè½´çš„å³è½´
ax2 = ax1.twinx() 

color_right = '#4ECDC4' # é’è‰²ä»£è¡¨å¢é•¿
ax2.set_ylabel('å® ç‰©å¸‚åœºè§„æ¨¡ (äº¿å…ƒ)', color=color_right)

# ç»˜åˆ¶æŸ±çŠ¶å›¾ (bar)
# alpha=0.3 è®¾ç½®é€æ˜åº¦ï¼Œé˜²æ­¢é®æŒ¡
ax2.bar(years, pet_economy, color=color_right, 
        alpha=0.3)

ax2.tick_params(axis='y', labelcolor=color_right)
                </div>
            </div>
            <div class="card">
                <h3>TwinX å‡½æ•°</h3>
                <p><code>ax2 = ax1.twinx()</code> åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„è½´ï¼Œå®ƒä¸ ax1 å…±äº« x è½´ã€‚</p>
                <p>æ³¨æ„ä½¿ç”¨é€æ˜åº¦ (alpha)ï¼Œç¡®ä¿æŸ±çŠ¶å›¾ä¸ä¼šå®Œå…¨é®æŒ¡èƒŒåçš„è¶‹åŠ¿çº¿ï¼ˆè™½ç„¶åœ¨æ­¤ä¾‹ä¸­æˆ‘ä»¬æ··ç”¨äº†æŠ˜çº¿å’ŒæŸ±çŠ¶ï¼‰ã€‚</p>
            </div>
        </div>
    </div>

    <div class="slide" id="s17">
        <div class="header"><h1 class="slide-title">Step 4: ç»†èŠ‚ä¸æ ‡æ³¨</h1></div>
        <div class="content split">
            <div class="card">
                 <div class="code-block">
# è§£å†³ä¸­æ–‡ä¹±ç 
plt.rcParams['font.sans-serif'] = ['SimHei']

# æ·»åŠ æ ‡é¢˜
plt.title("æ­¤æ¶ˆå½¼é•¿ï¼šå‡ºç”Ÿç‡ä¸å® ç‰©ç»æµè¶‹åŠ¿å¯¹æ¯”", 
          fontsize=14, pad=20)

# æ·»åŠ æ¥æºæ ‡æ³¨
plt.text(2018, 6000, 
         "æ•°æ®æ¥æº: å›½å®¶ç»Ÿè®¡å±€ / å® ç‰©è¡Œä¸šç™½çš®ä¹¦", 
         fontsize=8, color='gray')
                </div>
            </div>
            <div class="card">
                <h3>æ–°é—»è¦ç´ å®Œå–„</h3>
                <p>å›¾è¡¨ä¸ä»…è¦æ­£ç¡®ï¼Œè¿˜è¦ä¸“ä¸šã€‚</p>
                <p>æ ‡é¢˜å‘Šè¯‰è¯»è€…çœ‹ä»€ä¹ˆï¼Œæ¥æºæ ‡æ³¨å»ºç«‹å¯ä¿¡åº¦ã€‚</p>
            </div>
        </div>
    </div>

    <div class="slide" id="s18">
        <div class="header"><h1 class="slide-title">å¯è§†åŒ–æˆæœ</h1></div>
        <div class="content" style="background: #fff; padding: 20px; border-radius: 8px;">
            <div id="mainChart" style="width: 100%; height: 100%;"></div>
        </div>
    </div>

    <div class="slide" id="s19">
        <div class="header"><h1 class="slide-title">è§£è¯»ï¼šå®Œç¾çš„â€œXâ€äº¤å‰</h1></div>
        <div class="content split">
            <div class="card" style="border-left: 5px solid var(--accent-red);">
                <h3 style="color: var(--accent-red);">â†˜ å‡ºç”Ÿç‡ä¸‹é™</h3>
                <p>ä» 2018 å¹´çš„ 10.94â€° ä¸€è·¯ä¸‹æ»‘è‡³ 2023 å¹´çš„ 6.39â€°ã€‚</p>
            </div>
            <div class="card" style="border-left: 5px solid var(--accent-blue);">
                <h3 style="color: var(--accent-blue);">â†— ç»æµçˆ†å‘</h3>
                <p>å® ç‰©å¸‚åœºè§„æ¨¡åŒæœŸç¿»äº†ä¸‰å€ï¼Œè¾¾åˆ°è¿‘ 6000 äº¿å…ƒã€‚</p>
            </div>
        </div>
    </div>

    <div class="slide" id="s20">
        <div class="header"><h1 class="slide-title">è­¦æƒ•å› æœé™·é˜±</h1></div>
        <div class="content grid-2">
            <div class="card" style="background: rgba(255, 77, 79, 0.1); border-color: var(--accent-red);">
                <h3 style="color: var(--accent-red);">âŒ é”™è¯¯æ¨å¯¼</h3>
                <p>â€œå¹´è½»äººå› ä¸ºå…»çŒ«ï¼Œæ‰€ä»¥ä¸ç”Ÿå­©å­ã€‚â€</p>
                <p>è¿™æ˜¯ä¸€ç§æ‡’æƒ°çš„çº¿æ€§æ€ç»´ã€‚</p>
            </div>
            <div class="card">
                <h3 style="color: var(--accent);">âœ… ä¸“ä¸šåˆ¤æ–­</h3>
                <p><strong>Correlation â‰  Causation</strong></p>
                <p>è¿™åªæ˜¯<strong>ä¼´ç”Ÿç°è±¡</strong>ã€‚ä¸¤è€…å¯èƒ½å…±åŒå—åˆ°åŸå¸‚åŒ–å‹åŠ›ã€ç”Ÿæ´»æˆæœ¬ä¸Šå‡ã€è§‚å¿µè½¬å˜ç­‰ç¬¬ä¸‰æ–¹å˜é‡çš„å½±å“ã€‚</p>
            </div>
        </div>
    </div>

    <div class="slide" id="s21">
        <div class="content big-text">
            <h2 style="color: var(--text-secondary); margin-bottom: 20px;">PART 02</h2>
            <h1 style="font-size: 5rem; color: #fff;">æ–‡æœ¬æŒ–æ˜</h1>
            <h3 style="font-size: 2rem; color: var(--accent); margin-top: 20px;">ç®—æ³•çœ¼ä¸­çš„èˆ†è®ºåœº</h3>
        </div>
    </div>

    <div class="slide" id="s22">
        <div class="header"><h1 class="slide-title">æ•°æ®çš„ä¸¤å¼ é¢å­”</h1></div>
        <div class="content grid-2">
            <div class="card">
                <h3>ç»“æ„åŒ–æ•°æ® Structured</h3>
                <p>Excel, SQL, CSV</p>
                <p>è¡Œåˆ—åˆ†æ˜ï¼Œæ•°å€¼ä¸ºä¸»ï¼Œè®¡ç®—æœºæ˜“äºå¤„ç†ã€‚</p>
            </div>
            <div class="card">
                <h3>éç»“æ„åŒ–æ•°æ® Unstructured</h3>
                <p>æ–‡æœ¬, å›¾åƒ, éŸ³é¢‘</p>
                <p>åŒ…å«è¯­å¢ƒã€æƒ…æ„Ÿã€è®½åˆºï¼Œè®¡ç®—æœºå¤„ç†éš¾åº¦å¤§ã€‚</p>
                <p style="color: var(--accent);">æœ¬èŠ‚é‡ç‚¹ï¼šä¸­æ–‡æ–‡æœ¬ã€‚</p>
            </div>
        </div>
    </div>

    <div class="slide" id="s23">
        <div class="header"><h1 class="slide-title">æ¡ˆä¾‹ï¼šã€Šé»‘ç¥è¯ï¼šæ‚Ÿç©ºã€‹</h1></div>
        <div class="content split">
            <div class="card">
                <h3>æ•°æ®æº</h3>
                <p>å¾®åšçƒ­é—¨è¯é¢˜ä¸‹ Top 1000 æ¡ç”¨æˆ·è¯„è®ºã€‚</p>
            </div>
            <div class="card">
                <h3>åˆ†æç›®æ ‡</h3>
                <p>ä»æµ·é‡çš„æ‚ä¹±æ–‡æœ¬ä¸­ï¼Œæå–å‡ºå…¬ä¼—çš„<strong>æ ¸å¿ƒæƒ…ç»ª</strong>å’Œ<strong>å…³æ³¨ç„¦ç‚¹</strong>ã€‚</p>
            </div>
        </div>
    </div>

    <div class="slide" id="s24">
        <div class="header"><h1 class="slide-title">åŸå§‹è¯­æ–™çš„æŒ‘æˆ˜</h1></div>
        <div class="content grid-2">
            <div class="card">
                <div class="code-block" style="color: #888;">
"çœŸçš„å“­äº†ï¼Œç‰‡å¤´éŸ³ä¹ä¸€å“..."
"å°±æ˜¯è§‰å¾—æœ‰ç‚¹å¡..."
"é‚£ä¸ªç‰¹æ•ˆçœŸçš„ç»äº†..."
"ä»€ä¹ˆç¥ä»™ç”»è´¨..."
"è¿˜å¾—æ˜¯å›½äº§..."
                </div>
            </div>
            <div class="card">
                <h3>è™šè¯å¹²æ‰°</h3>
                <p>å¦‚æœæˆ‘ä»¬ç›´æ¥ç»Ÿè®¡è¯é¢‘ï¼Œå‡ºç°æœ€å¤šçš„è¯ä¼šæ˜¯ï¼š</p>
                <p style="font-size: 2rem; color: var(--accent-red);">"çœŸçš„", "å°±æ˜¯", "äº†", "ä»€ä¹ˆ"</p>
                <p>è¿™äº›è¯æ²¡æœ‰å®é™…æ„ä¹‰ã€‚</p>
            </div>
        </div>
    </div>

    <div class="slide" id="s25">
        <div class="header"><h1 class="slide-title">æ ¸å¿ƒæœºåˆ¶ï¼šåœç”¨è¯ Stop Words</h1></div>
        <div class="content grid-3">
            <div class="card">
                <h3>1. è¯†åˆ«å™ªéŸ³</h3>
                <p>æ‰¾å‡ºæ–‡æœ¬ä¸­æ— æ„ä¹‰çš„é«˜é¢‘è™šè¯ã€è¯­æ°”è¯ã€æ ‡ç‚¹ç¬¦å·ã€‚</p>
            </div>
            <div class="card">
                <h3>2. æ„å»ºè¯è¡¨</h3>
                <p>åˆ›å»ºä¸€ä¸ª Listï¼ŒåŒ…å«æ‰€æœ‰éœ€è¦å‰”é™¤çš„è¯ã€‚</p>
                <p class="code-block" style="font-size: 0.8rem;">stop = ['çœŸçš„', 'å°±æ˜¯', ...]</p>
            </div>
            <div class="card">
                <h3>3. è¿‡æ»¤æ¸…æ´—</h3>
                <p>éå†åˆ†è¯ç»“æœï¼Œä»…ä¿ç•™ä¸åœ¨åœç”¨è¯è¡¨ä¸­çš„å®è¯ã€‚</p>
            </div>
        </div>
    </div>

    <div class="slide" id="s26">
        <div class="header"><h1 class="slide-title">ç®—æ³•æŠŠå…³äºº Gatekeeper</h1></div>
        <div class="content split">
            <div class="card">
                <h3>Editorial Judgment</h3>
                <p>å®šä¹‰åœç”¨è¯è¡¨çš„è¿‡ç¨‹ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯<strong>æ–°é—»ç¼–è¾‘è¡Œä½¿æƒåŠ›</strong>çš„è¿‡ç¨‹ã€‚</p>
            </div>
            <div class="card" style="border-color: var(--accent-red);">
                <h3 style="color: var(--accent-red);">ä¼¦ç†è­¦ç¤º</h3>
                <p>å¦‚æœä½ åœ¨åœç”¨è¯è¡¨ä¸­åŠ å…¥äº†â€œå¡é¡¿â€ã€â€œæ‰å¸§â€ã€â€œä¼˜åŒ–å·®â€...</p>
                <p>ä½ å°±åœ¨äººä¸ºåˆ¶é€ â€œæŠ¥å–œä¸æŠ¥å¿§â€çš„å‡è±¡ã€‚</p>
                <p><strong>ä½ åˆ é™¤äº†ä»€ä¹ˆï¼Œå†³å®šäº†è¯»è€…çœ‹åˆ°ä»€ä¹ˆã€‚</strong></p>
            </div>
        </div>
    </div>

    <div class="slide" id="s27">
        <div class="header"><h1 class="slide-title">ä»£ç å®ç°ï¼šJieba åˆ†è¯</h1></div>
        <div class="content split">
            <div class="card">
                <div class="code-block">
import jieba

text = "é»‘ç¥è¯å¤ªç‰›äº†ï¼Œä½†æ˜¯ä¼˜åŒ–æœ‰ç‚¹å·®"
stopwords = {'ä½†æ˜¯', 'æœ‰ç‚¹', 'äº†'}

# 1. ç²¾ç»†åŒ–åˆ†è¯
words = jieba.lcut(text)
# output: ['é»‘ç¥è¯', 'å¤ª', 'ç‰›', 'äº†', 'ä½†æ˜¯', 'ä¼˜åŒ–', 'æœ‰ç‚¹', 'å·®']

# 2. åœç”¨è¯è¿‡æ»¤ (List Comprehension)
clean = [w for w in words if w not in stopwords]
# output: ['é»‘ç¥è¯', 'å¤ª', 'ç‰›', 'ä¼˜åŒ–', 'å·®']
                </div>
            </div>
            <div class="card">
                <h3>é€»è¾‘è§£æ</h3>
                <p><code>jieba.lcut</code>ï¼šå°†è¿ç»­çš„å¥å­åˆ‡åˆ†æˆè¯è¯­åˆ—è¡¨ã€‚</p>
                <p><code>if w not in stopwords</code>ï¼šæ ¸å¿ƒè¿‡æ»¤é€»è¾‘ã€‚</p>
            </div>
        </div>
    </div>

    <div class="slide" id="s28">
        <div class="header"><h1 class="slide-title">èˆ†è®ºåœºå¯è§†åŒ–</h1></div>
        <div class="content" style="position: relative;">
            <div class="word-cloud" id="wordCloudContainer">
                </div>
        </div>
    </div>

    <div class="slide" id="s29">
        <div class="header"><h1 class="slide-title">AI è¾…åŠ©ç¼–ç¨‹æ–°èŒƒå¼</h1></div>
        <div class="content grid-2">
            <div class="card">
                <h3>âŒ æ—§æ¨¡å¼</h3>
                <p>æ­»è®°ç¡¬èƒŒæ¯ä¸€è¡Œä»£ç è¯­æ³•ã€‚</p>
                <p>ä¸€æ—¦æŠ¥é”™å°±æŸæ‰‹æ— ç­–ã€‚</p>
            </div>
            <div class="card">
                <h3>âœ… Prompt Engineering</h3>
                <p>å­¦ä¼šå‘ AI æé—®ï¼š</p>
                <p class="code-block" style="font-size: 0.9rem;">"ä½œä¸ºä¸€åæ•°æ®æ–°é—»ç¼–è¾‘ï¼Œè¯·å¸®æˆ‘ç”¨ Python åˆ†æè¿™ç¯‡ txt æ–‡æ¡£ã€‚è¯·ä½¿ç”¨ jieba åˆ†è¯ï¼Œå»é™¤é€šç”¨åœç”¨è¯ï¼Œå¹¶ç»˜åˆ¶ Top 20 æŸ±çŠ¶å›¾..."</p>
            </div>
        </div>
    </div>

    <div class="slide" id="s30">
        <div class="header"><h1 class="slide-title">è¯¾åä½œä¸šï¼šå¯»æ‰¾â€œæ²‰é»˜çš„æ•°æ®â€</h1></div>
        <div class="content grid-2">
            <div class="card">
                <h3>ä»»åŠ¡</h3>
                <p>åˆ©ç”¨æœ¬èŠ‚è¯¾å­¦åˆ°çš„â€œåŒè½´å›¾â€æˆ–â€œæ–‡æœ¬åˆ†æâ€æŠ€æœ¯ï¼Œå®Œæˆä¸€ä»½å¾®å‹æ•°æ®æ–°é—»ç¨¿ã€‚</p>
            </div>
            <div class="card">
                <h3>æ ¸å¿ƒè¦æ±‚</h3>
                <p>å¿…é¡»åœ¨é™„å½•ä¸­è¯´æ˜ä½ åœ¨æ•°æ®æ¸…æ´—æ—¶çš„<strong>ä¸»è§‚è€ƒé‡</strong>ã€‚</p>
                <p>â€”â€” ä½ åˆ é™¤äº†ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</p>
            </div>
        </div>
    </div>

    <div class="controls">
        <button class="btn" onclick="prevSlide()">â† Prev</button>
        <span class="page-indicator" id="pageIndicator">1 / 30</span>
        <button class="btn" onclick="nextSlide()">Next â†’</button>
        <button class="btn" onclick="downloadPDF()" style="margin-left: 20px;">Download PDF</button>
    </div>

</div>

<script>
    // çŠ¶æ€ç®¡ç†
    let currentSlide = 0;
    const slides = document.querySelectorAll('.slide');
    const totalSlides = slides.length;
    const indicator = document.getElementById('pageIndicator');
    let chartInstance = null;

    // åˆå§‹åŒ–
    function init() {
        updateSlide();
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight' || e.key === ' ') nextSlide();
            if (e.key === 'ArrowLeft') prevSlide();
        });
        
        // é¢„ç”Ÿæˆè¯äº‘
        generateWordCloud();
    }

    // ç¿»é¡µé€»è¾‘
    function updateSlide() {
        slides.forEach((slide, index) => {
            if (index === currentSlide) {
                slide.classList.add('active');
                animateSlide(slide, index);
            } else {
                slide.classList.remove('active');
            }
        });
        indicator.textContent = `${currentSlide + 1} / ${totalSlides}`;
        
        // è§¦å‘ç‰¹å®šå›¾è¡¨
        if (slides[currentSlide].id === 's18') renderChart();
    }

    function nextSlide() {
        if (currentSlide < totalSlides - 1) {
            currentSlide++;
            updateSlide();
        }
    }

    function prevSlide() {
        if (currentSlide > 0) {
            currentSlide--;
            updateSlide();
        }
    }

    // GSAP åŠ¨æ•ˆ
    function animateSlide(slide, index) {
        // é‡ç½®å…ƒç´ çŠ¶æ€
        const cards = slide.querySelectorAll('.card');
        const title = slide.querySelector('.slide-title');
        const code = slide.querySelector('.code-block');
        
        gsap.killTweensOf([cards, title, code]);
        
        if (title) {
            gsap.fromTo(title, 
                { y: -20, opacity: 0 },
                { y: 0, opacity: 1, duration: 0.6, ease: "power2.out" }
            );
        }

        if (cards.length > 0) {
            gsap.fromTo(cards, 
                { y: 30, opacity: 0 },
                { y: 0, opacity: 1, duration: 0.6, stagger: 0.1, ease: "power2.out", delay: 0.2 }
            );
        }

        if (code) {
            gsap.fromTo(code,
                { opacity: 0 },
                { opacity: 1, duration: 1, delay: 0.5 }
            );
        }
    }

    // æ¸²æŸ“ ECharts å›¾è¡¨ (S18)
    function renderChart() {
        const dom = document.getElementById('mainChart');
        if (chartInstance) chartInstance.dispose();
        
        chartInstance = echarts.init(dom);
        
        const option = {
            backgroundColor: '#ffffff',
            tooltip: { trigger: 'axis' },
            legend: { data: ['å‡ºç”Ÿç‡', 'å¸‚åœºè§„æ¨¡'], bottom: 10 },
            xAxis: { 
                data: ['2018', '2019', '2020', '2021', '2022', '2023'],
                axisLine: { lineStyle: { color: '#666' } }
            },
            yAxis: [
                {
                    type: 'value',
                    name: 'å‡ºç”Ÿç‡ (â€°)',
                    min: 0, max: 15,
                    position: 'left',
                    axisLine: { show: true, lineStyle: { color: '#FF6B6B' } },
                    axisLabel: { color: '#FF6B6B' }
                },
                {
                    type: 'value',
                    name: 'å¸‚åœºè§„æ¨¡ (äº¿å…ƒ)',
                    min: 0, max: 6000,
                    position: 'right',
                    axisLine: { show: true, lineStyle: { color: '#4ECDC4' } },
                    axisLabel: { color: '#4ECDC4' },
                    splitLine: { show: false }
                }
            ],
            series: [
                {
                    name: 'å‡ºç”Ÿç‡',
                    type: 'line',
                    data: [10.94, 10.48, 8.52, 7.52, 6.77, 6.39],
                    itemStyle: { color: '#FF6B6B' },
                    lineStyle: { width: 4 },
                    symbolSize: 8,
                    animationDuration: 1500
                },
                {
                    name: 'å¸‚åœºè§„æ¨¡',
                    type: 'bar',
                    yAxisIndex: 1,
                    data: [1708, 2024, 2953, 3942, 4936, 5928],
                    itemStyle: { color: '#4ECDC4', opacity: 0.6 },
                    barWidth: '40%',
                    animationDuration: 1500,
                    animationDelay: 500
                }
            ]
        };
        
        chartInstance.setOption(option);
    }

    // ç”Ÿæˆæ¨¡æ‹Ÿè¯äº‘ (S28)
    function generateWordCloud() {
        const container = document.getElementById('wordCloudContainer');
        const words = [
            { text: "é»‘ç¥è¯", size: 60, color: "#00ff88" },
            { text: "å›½äº§ä¹‹å…‰", size: 50, color: "#00ff88" },
            { text: "æ–‡åŒ–è¾“å‡º", size: 45, color: "#00d084" },
            { text: "æ˜¾å¡", size: 40, color: "#fff" },
            { text: "ä¼˜åŒ–", size: 40, color: "#fff" },
            { text: "æ‰å¸§", size: 30, color: "#ccc" },
            { text: "è¥¿æ¸¸è®°", size: 35, color: "#00ff88" },
            { text: "æ‰“å‡»æ„Ÿ", size: 30, color: "#ccc" },
            { text: "BOSS", size: 25, color: "#888" },
            { text: "ç©ºæ°”å¢™", size: 25, color: "#888" },
            { text: "å‰§æƒ…", size: 30, color: "#fff" },
            { text: "ç¾æœ¯", size: 35, color: "#00d084" }
        ];

        words.forEach(w => {
            const el = document.createElement('div');
            el.className = 'word';
            el.textContent = w.text;
            el.style.fontSize = w.size + 'px';
            el.style.color = w.color;
            // éšæœºåˆ†å¸ƒ
            el.style.left = Math.random() * 80 + 10 + '%';
            el.style.top = Math.random() * 80 + 10 + '%';
            container.appendChild(el);
        });

        // è¯äº‘åŠ¨æ•ˆ
        const obs = new MutationObserver((mutations) => {
            if(document.getElementById('s28').classList.contains('active')) {
                gsap.to('.word', {
                    opacity: 1,
                    scale: 1,
                    duration: 0.8,
                    stagger: { amount: 1, from: "random" },
                    ease: "back.out(1.7)"
                });
            } else {
                gsap.set('.word', { opacity: 0, scale: 0 });
            }
        });
        obs.observe(document.getElementById('s28'), { attributes: true });
    }

    // PDF ä¸‹è½½åŠŸèƒ½
    async function downloadPDF() {
        const btn = document.querySelector('.controls button[onclick="downloadPDF()"]');
        btn.textContent = "Generating...";
        
        const pdf = new jspdf.jsPDF({
            orientation: 'landscape',
            unit: 'px',
            format: [1920, 1080]
        });

        const stage = document.getElementById('stage-container');
        
        // ä¸´æ—¶ç§»é™¤ transform å’Œéšè—éå½“å‰ slide
        const originalStyles = [];
        slides.forEach(s => {
            originalStyles.push({ opacity: s.style.opacity, display: s.style.display, visibility: s.style.visibility });
            s.style.opacity = '1';
            s.style.visibility = 'visible';
            s.style.display = 'flex'; // å¼ºåˆ¶æ˜¾ç¤ºæ‰€æœ‰ä»¥ä¾¿æˆªå›¾ï¼Œä½†è¿™æ ·ä¼šé‡å 
            // å®é™…ç­–ç•¥ï¼šé€é¡µæ˜¾ç¤ºæˆªå›¾
            s.style.display = 'none';
        });

        // éšè—æ§åˆ¶æ 
        document.querySelector('.controls').style.display = 'none';

        for (let i = 0; i < totalSlides; i++) {
            // æ˜¾ç¤ºå½“å‰é¡µ
            slides[i].style.display = 'flex';
            slides[i].style.opacity = '1';
            slides[i].style.visibility = 'visible';
            
            // å¼ºåˆ¶æ¸²æŸ“å›¾è¡¨
            if (slides[i].id === 's18' && chartInstance) {
                chartInstance.resize();
            }

            await new Promise(r => setTimeout(r, 100)); // ç­‰å¾…æ¸²æŸ“

            const canvas = await html2canvas(stage, {
                scale: 1, // é™ä½åˆ†è¾¨ç‡ä»¥æå‡é€Ÿåº¦ï¼Œå¯¼å‡ºåŸå›¾å¯è®¾ä¸º 2
                backgroundColor: '#000000',
                useCORS: true
            });

            const imgData = canvas.toDataURL('image/jpeg', 0.9);
            
            if (i > 0) pdf.addPage([1920, 1080]);
            pdf.addImage(imgData, 'JPEG', 0, 0, 1920, 1080);
            
            // éšè—å½“å‰é¡µ
            slides[i].style.display = 'none';
        }

        // æ¢å¤çŠ¶æ€
        slides.forEach((s, i) => {
            s.style.opacity = originalStyles[i].opacity;
            s.style.visibility = originalStyles[i].visibility;
            s.style.display = i === currentSlide ? 'flex' : 'flex'; // æ¢å¤ flex å¸ƒå±€
            if (i !== currentSlide) s.classList.remove('active');
            else s.classList.add('active');
        });
        document.querySelector('.controls').style.display = 'flex';
        btn.textContent = "Download PDF";
        
        pdf.save('data-narrative-slides.pdf');
    }

    // å¯åŠ¨
    init();

</script>
</body>
</html>